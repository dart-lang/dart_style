>>>
bool _hasLibraryDirective(String code) =>
    parseDirectives(code, suppressErrors: true)
        .directives.any((d) => d is LibraryDirective);
<<<
bool _hasLibraryDirective(String code) =>
    parseDirectives(code, suppressErrors: true)
        .directives
        .any((d) => d is LibraryDirective);